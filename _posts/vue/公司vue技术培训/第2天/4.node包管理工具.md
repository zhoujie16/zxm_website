---
title: 第二天 2-4 npm介绍
date: 2019-08-07 04:00:00
tags:
categories: 公司vue技术培训
---

nodejs已经集成了npm，安装了node就有了npm

```
为啥我们需要一个包管理工具呢？因为我们在Node.js上开发时，会用到很多别人写的JavaScript代码。如果我们要使用别人写的某个包，每次都根据名称搜索一下官方网站，下载代码，解压，再使用，非常繁琐。于是一个集中管理的工具应运而生：大家都把自己开发的模块打包后放到npm官网上，如果要使用，直接通过npm安装就可以直接用，不用管代码存在哪，应该从哪下载。
```

### npm能干什么

- 从NPM服务器下载别人编写的第三方包到本地使用
- 从NPM服务器下载并安装别人编写的命令行程序到本地使用
- 将自己编写的包或命令行程序上传到NPM服务器供别人使用

### npm切换镜像源

```shell
# 设置镜像地址 为国内的淘宝镜像
npm config set registry https://registry.npm.taobao.org
# 配置后可通过下面方式来验证是否成功
npm config get registry
# 还原镜像地址
npm config set registry https://registry.npmjs.org
```



## yarn介绍

Yarn 是 Facebook, Google, Exponent 和 Tilde 开发的一款新的 JavaScript 包管理工具。

官方文档：它的目的是解决这些团队使用 npm 面临的少数问题，即：

安装的时候无法保证速度/一致性
安全问题，因为 npm 安装时允许运行代码

Yarn 同样是一个从 npm 注册源获取模块的新的 CLI 客户端。注册的方式不会有任何变化 —— 你同样可以正常获取与发布包。



### Yarn的优点？

- **速度快**。速度快主要来自以下两个方面：

1. 并行安装：无论 npm 还是 Yarn 在执行包的安装时，都会执行一系列任务。npm 是按照队列执行每个 package，也就是说必须要等到当前 package 安装完成之后，才能继续后面的安装。而 Yarn 是同步执行所有任务，提高了性能。
2. 离线模式：如果之前已经安装过一个软件包，用Yarn再次安装时之间从缓存中获取，就不用像npm那样再从网络下载了。

- 安装**版本统一**：为了防止拉取到不同的版本，Yarn 有一个锁定文件 (lock file) 记录了被确切安装上的模块的版本号。每次只要新增了一个模块，Yarn 就会创建（或更新）yarn.lock 这个文件。这么做就保证了，每一次拉取同一个项目依赖时，使用的都是一样的模块版本。npm 其实也有办法实现处处使用相同版本的 packages，但需要开发者执行 npm shrinkwrap 命令。这个命令将会生成一个锁定文件，在执行 npm install 的时候，该锁定文件会先被读取，和 Yarn 读取 yarn.lock 文件一个道理。npm 和 Yarn 两者的不同之处在于，Yarn 默认会生成这样的锁定文件，而 npm 要通过 shrinkwrap 命令生成 npm-shrinkwrap.json 文件，只有当这个文件存在的时候，packages 版本信息才会被记录和更新。
- **更简洁的输出**：npm 的输出信息比较冗长。在执行 npm install <package> 的时候，命令行里会不断地打印出所有被安装上的依赖。相比之下，Yarn 简洁太多：默认情况下，结合了 emoji直观且直接地打印出必要的信息，也提供了一些命令供开发者查询额外的安装信息。
- **多注册来源处理：**所有的依赖包，不管他被不同的库间接关联引用多少次，安装这个包时，只会从一个注册来源去装，要么是 npm 要么是 bower, 防止出现混乱不一致。
- **更好的语义化**： yarn改变了一些npm命令的名称，比如 yarn add/remove，感觉上比 npm 原本的 install/uninstall 要更清晰。

```
总之：yarn 和 npm 的功能是完全一样的，yarn 比 npm 好用
```

### 安装yarn

参照文档 [安装yarn](https://www.yarnpkg.com/zh-Hans/docs/install#mac-stable)

```shell
# 安装
npm install yarn -g
# 安装成功后输入 yarn -v 会显示正确的版本号
yarn -v
```



### yarn 切换镜像源

```shell
# 查看一下当前源
yarn config get registry
# 切换为淘宝源
yarn config set registry https://registry.npm.taobao.org
# 还原默认地址
yarn config set registry https://registry.yarnpkg.com
```

### yarn常用命令

**添加依赖包**

```shell
# 添加依赖包
yarn add [package]
# 添加依赖包 指定版本
yarn add [package]@[version]
# 添加依赖包 全局
yarn global add [package]
```

**将依赖项添加到不同依赖项类别**

添加到 `devDependencies`：

```shell
yarn add [package] --dev
```

**升级依赖包**

```shell
yarn upgrade [package]
yarn upgrade [package]@[version]
```

**移除依赖包**

```shell
yarn remove [package]
```

**安装项目的全部依赖**

```shell
yarn 或者 yarn install
```

## yarn 与 npm 命令比较

| npm                                  | Yarn                         |
| :----------------------------------- | :--------------------------- |
| `npm install`                        | `yarn install`               |
| `npm install [package]`              | `yarn add [package]`         |
| `npm install [package] --save-dev`   | `yarn add [package] --dev`   |
| `npm install [package] --global`     | `yarn global add [package]`  |
| `npm update --global`                | `yarn global upgrade`        |
| `npm uninstall [package]`            | `yarn remove [package]`      |
| `npm cache clean`                    | `yarn cache clean [package]` |
| `rm -rf node_modules && npm install` | `yarn upgrade`               |

### 安装vue脚手架

```shell
# 可以使用下列任一命令安装这个新的包
npm install -g @vue/cli
# OR
yarn global add @vue/cli
```

安装之后，你就可以在命令行中访问 `vue` 命令。你可以通过简单运行 `vue`，看看是否展示出了一份所有可用命令的帮助信息，来验证它是否安装成功。

```shell
vue --version
```

